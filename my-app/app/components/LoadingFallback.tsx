'use client'

import { useState, useEffect } from 'react'

type Theme = 'light' | 'dark' | 'green'
type CollegeTheme = 'default' | 'science' | 'arts-letters' | 'architecture'

interface LoadingFallbackProps {
  message?: string
  variant?: 'page' | 'modal' | 'inline'
  theme?: Theme
  showSpinner?: boolean
}

export default function LoadingFallback({
  message = 'Loading...',
  variant = 'page',
  showSpinner = true
}: LoadingFallbackProps) {
  const [theme, setTheme] = useState<Theme>('green')
  const [collegeTheme, setCollegeTheme] = useState<CollegeTheme>('default')
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    if (typeof window !== 'undefined') {\n      // Try to read from localStorage\n      const savedTheme = localStorage.getItem('faculty-base-theme') || localStorage.getItem('admin-base-theme') || 'green'\n      setTheme(savedTheme as Theme)\n\n      const savedCollegeTheme = localStorage.getItem('faculty-college-theme')\n      if (savedCollegeTheme && ['science', 'arts-letters', 'architecture'].includes(savedCollegeTheme)) {\n        setCollegeTheme(savedCollegeTheme as CollegeTheme)\n      }\n      setMounted(true)\n    }\n  }, [])\n\n  if (!mounted) return null\n\n  // Color mapping for themes\n  const getColorScheme = () => {\n    const isLight = theme === 'light'\n    if (isLight) {\n      switch (collegeTheme) {\n        case 'science':\n          return { primary: '#0284c7', secondary: '#38bdf8', bg: '#f0f9ff' }\n        case 'arts-letters':\n          return { primary: '#7e22ce', secondary: '#d8b4fe', bg: '#faf5ff' }\n        case 'architecture':\n          return { primary: '#ea580c', secondary: '#fb923c', bg: '#fff7ed' }\n        default:\n          return { primary: '#10b981', secondary: '#34d399', bg: '#ffffff' }\n      }\n    } else {\n      switch (collegeTheme) {\n        case 'science':\n          return { primary: '#0284c7', secondary: '#0284c7', bg: '#001f3f' }\n        case 'arts-letters':\n          return { primary: '#a855f7', secondary: '#a855f7', bg: '#1e1033' }\n        case 'architecture':\n          return { primary: '#f97316', secondary: '#f97316', bg: '#1f1010' }\n        default:\n          return { primary: '#00d4ff', secondary: '#00d4ff', bg: '#0a0e27' }\n      }\n    }\n  }\n\n  const colors = getColorScheme()\n\n  if (variant === 'page') {\n    return (\n      <div\n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '20px',\n          background: colors.bg,\n          color: colors.primary,\n          zIndex: 9999,\n          overflow: 'hidden'\n        }}\n        data-theme={theme}\n        data-college-theme={collegeTheme}\n      >\n        {/* Background glow effect */}\n        <div\n          style={{\n            position: 'absolute',\n            inset: 0,\n            background: `radial-gradient(circle at 50% 50%, ${colors.secondary}15 0%, transparent 70%)`,\n            animation: 'pulseGlow 3.5s ease-in-out infinite',\n            pointerEvents: 'none'\n          }}\n        />\n\n        {/* Spinner */}\n        {showSpinner && (\n          <div\n            style={{\n              width: '56px',\n              height: '56px',\n              border: `4px solid ${colors.secondary}40`,\n              borderTopColor: colors.primary,\n              borderRadius: '50%',\n              animation: 'spin 0.8s linear infinite',\n              boxShadow: `0 0 24px ${colors.secondary}40`,\n              position: 'relative',\n              zIndex: 2\n            }}\n          />\n        )}\n\n        {/* Message */}\n        {message && (\n          <p\n            style={{\n              fontSize: '15px',\n              fontWeight: 500,\n              color: colors.primary,\n              margin: 0,\n              position: 'relative',\n              zIndex: 2\n            }}\n          >\n            {message}\n          </p>\n        )}\n\n        {/* Styles */}\n        <style jsx>{`\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n          @keyframes pulseGlow {\n            0%, 100% { opacity: 0.3; }\n            50% { opacity: 0.6; }\n          }\n        `}</style>\n      </div>\n    )\n  }\n\n  if (variant === 'modal') {\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '16px',\n          padding: '48px 24px',\n          minHeight: '300px'\n        }}\n      >\n        {showSpinner && (\n          <div\n            style={{\n              width: '48px',\n              height: '48px',\n              border: `4px solid ${colors.secondary}40`,\n              borderTopColor: colors.primary,\n              borderRadius: '50%',\n              animation: 'spin 0.8s linear infinite',\n              boxShadow: `0 0 16px ${colors.secondary}30`\n            }}\n          />\n        )}\n        {message && <p style={{ color: colors.primary, fontSize: '14px', margin: 0 }}>{message}</p>}\n        <style jsx>{`\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        `}</style>\n      </div>\n    )\n  }\n\n  // inline variant\n  return (\n    <div\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        gap: '12px',\n        padding: '16px'\n      }}\n    >\n      {showSpinner && (\n        <div\n          style={{\n            width: '36px',\n            height: '36px',\n            border: `3px solid ${colors.secondary}40`,\n            borderTopColor: colors.primary,\n            borderRadius: '50%',\n            animation: 'spin 0.8s linear infinite'\n          }}\n        />\n      )}\n      {message && <span style={{ color: colors.primary, fontSize: '13px' }}>{message}</span>}\n      <style jsx>{`\n        @keyframes spin {\n          to { transform: rotate(360deg); }\n        }\n      `}</style>\n    </div>\n  )\n}\n